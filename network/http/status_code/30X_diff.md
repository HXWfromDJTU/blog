## 302 303 307
___
如果客户端发出非 `GET`、`HEAD`请求后，收到服务端的 `302` 状态码，那么就不能自动的向新 `URI` 发送重复请求，除非得到用户的确认。

因为第二次 `POST` 时，环境可能已经发生变化（`POST` 方法不是幂等），`POST` 操作会不符合用户预期。

所以很多浏览器（`user agent`）在这种情况下都会把 `POST` 请求变为`GET`请求。



但是，很多浏览器都把 `302` 当作 `303` 处理了（注意，`303` 是 `HTTP1.1` 才加进来的，其实从 `HTTP1.0` 进化到 `HTTP1.1`，浏览器什么都没动），它们获取到 `HTTP` 响应报文头部的 `Location` 字段信息，并发起一个 `GET` 请求。

### 307
在 `GET`、`HEAD` 这些幂等的请求方式上，`302`、`303`、`307` 没啥区别。

而对于 `POST` 就不同了
* 大部分浏览器 都会 `302` 会将 `POST` 请求转为 `GET`
* `303` 是规范强制规定将 `POST` 转为 `GET` 请求，请求地址为 `header` 头中的 `Location`
*  `307` 则不一样，规范要求浏览器继续向 `Location` 的地址 `POST` 内容。

### 307 与 HSTS
`hsts`全称`HTTP`严格传输安全（`HTTP Strict Transport Security`，縮寫：`HSTS`），功能是要求浏览器下次访问该站点时使用`https`来访问，而不再需要先是`http`再转`https`。

这样可以避免`ssl`剥离攻击，即攻击者在用户使用`http`访问的过程中进行攻击，对服务器冒充自己是用户，在攻击者和服务器中使用`https`访问，在用户和服务器中使用`http`访问。

* 服务器在接收到`http`类型的请求，返回时会添加一个`Strict-Tramsport-Security`值进入响应报文中，这个值可以设置一个`max-age`
* 用下次如果再使用`http`访问，则只要`max-age`未过期，客户端会进行内部跳转，可以看到`307 Redirect Internel`的响应码
* 本次请求会被修改为`https`访问源服务器。

而在 `HSTS` 中，`307` 可以被缓存，缓存时间根据 `max-age` 而定，一般建议缓存` 1 年`甚至更长。

### HSTS注意事项
* 必须首先对 服务器`HTTPS`进行配置，再开启`STS`的响应头。否则，你设置了一个很长的过期时间，你的用户都会背引流到`https`，那么你的服务就会无法访问。
* `HSTS`只能够在`80`和`443`端口之间切换，若果服务是`8080`端口，那么即使设置了`STS`也会无效。
* `HSTS`无法处理纯`IP`请求，`HSTS`没法处理，比如`http:172.30.47.94`，即便响应头中设置了`STS`，但是浏览器也不会识别。
___
### 总结
* `HSTS`在切换全站`https`有一个交大的正向作用。